<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>XOZY-EP // MODULAR</title>
  <link rel="stylesheet" href="style.css">
</head>
<body id="main-body">

<div class="chassis" id="app-chassis">
  <div class="header-row">
    <h1>XOZY-EP</h1>
    <div class="header-controls">
      <select id="theme-select" class="btn-layout" onchange="setThemeOverride(this.value)">
        <option value="auto">THEME: AUTO</option>
        <option value="40">THEME: 40</option>
        <option value="133">THEME: 133</option>
        <option value="1320">THEME: 1320</option>
      </select>
      <button onclick="toggleDark()" class="btn-layout">NIGHT</button>
    </div>
  </div>

  <div class="lcd-display" id="log">
    <div class="log-entry">SYSTEM LOADING...</div>
  </div>

  <div class="main-deck">
    <div class="deck-left">
      <button class="btn-main primary" id="init-btn" style="margin-bottom:20px;">INITIALIZE MIDI</button>

      <div class="control-group" style="margin-bottom: 20px;">
        <div class="config-grid">
          <div><label>BPM</label><input type="number" id="tempo" value="120"></div>
          <div><label>LENGTH</label><select id="global-bars"><option value="4">4 Bars</option><option value="8">8 Bars</option></select></div>
        </div>
        <div style="margin-top:10px;"><label>SWING</label><input type="range" class="knob" id="swing-slider" min="0" max="75" value="0"></div>
        <div style="margin-top:10px;"><button id="transport-btn" class="btn-small btn-toggle-on">TX: START/STOP</button></div>
      </div>

      <div class="performance-container">
        <div class="group-strip">
          <button class="group-btn active" id="grp-0">A</button>
          <button class="group-btn" id="grp-1">B</button>
          <button class="group-btn" id="grp-2">C</button>
          <button class="group-btn" id="grp-3">D</button>
        </div>
        <div class="ep-grid" id="pad-grid"></div>
      </div>

      <div id="pad-perf" class="control-group" style="margin-top:20px;">
        <div class="config-grid">
          <div><label>NOTE</label><input type="number" id="pad-midi-note" onchange="updatePadParam('midiNote', this.value)"></div>
          <div><label>GATE</label><input type="number" id="pad-gate-ms" onchange="updatePadParam('gateMs', this.value)"></div>
          <div><label>VEL MODE</label><select id="pad-vel-mode" onchange="updatePadParam('velMode', this.value)"><option value="xyz">XYZ Levels</option><option value="fixed">Fixed</option><option value="range">Random</option></select></div>
          <div><label>VEL A</label><input type="number" id="pad-vel-a" onchange="updatePadParam('velA', this.value)"></div>
          <div><label>VEL B</label><input type="number" id="pad-vel-b" onchange="updatePadParam('velB', this.value)"></div>
        </div>
      </div>
    </div>

    <div class="deck-right" style="display:flex; flex-direction:column;">
      <div class="editor-panel" id="editor">
        <div class="editor-header">
          <strong id="editor-title">PAD SELECT</strong>
          <div>
            <button id="pad-mode-drum" onclick="setPadMode('drum')" class="btn-small btn-toggle-on" style="width:auto;">DRUM</button>
            <button id="pad-mode-chord" onclick="setPadMode('chord')" class="btn-small" style="width:auto;">CHORD</button>
          </div>
        </div>

        <div id="chord-lab" class="control-group" style="display:none;">
          <div class="piano-wrapper">
            <div class="octave-stack">
              <button class="oct-btn" onclick="shiftOctave(1)">+</button>
              <div class="oct-readout"><span id="octave-display">3</span></div>
              <button class="oct-btn" onclick="shiftOctave(-1)">â€“</button>
            </div>
            
            <div class="kb-octave" id="kb-keys">
               <div class="kb-whites">
                 <div class="kb-white kb-key" data-note="0"></div>
                 <div class="kb-white kb-key" data-note="2"></div>
                 <div class="kb-white kb-key" data-note="4"></div>
                 <div class="kb-white kb-key" data-note="5"></div>
                 <div class="kb-white kb-key" data-note="7"></div>
                 <div class="kb-white kb-key" data-note="9"></div>
                 <div class="kb-white kb-key" data-note="11"></div>
               </div>
               <div class="kb-blacks">
                 <div class="kb-black kb-key" data-note="1" style="left: 10.8%;"></div>
                 <div class="kb-black kb-key" data-note="3" style="left: 25.6%;"></div>
                 <div class="kb-black kb-key" data-note="6" style="left: 54.0%;"></div>
                 <div class="kb-black kb-key" data-note="8" style="left: 69.0%;"></div>
                 <div class="kb-black kb-key" data-note="10" style="left: 83.8%;"></div>
               </div>
            </div>
          </div>
          
          <div class="config-grid">
             <select id="chord-root" style="display:none;" onchange="updateChordParam('root', this.value)"><option value="0">C</option></select>
             <select id="chord-oct" style="display:none;" onchange="updateChordParam('oct', this.value)"><option value="3">3</option></select>

             <div><label>QUALITY</label><select id="chord-quality" onchange="updateChordParam('quality', this.value)"><option value="maj">Major</option><option value="min">Minor</option></select></div>
             <div><label>EXT</label><select id="chord-ext" onchange="updateChordParam('ext', this.value)"><option value="none">None</option><option value="7">7th</option><option value="9">9th</option></select></div>
             <div><label>INV</label><select id="chord-inv" onchange="updateChordParam('inv', this.value)"><option value="0">Root</option><option value="1">1st</option><option value="2">2nd</option></select></div>
             <div><label>FLUX</label><input type="range" class="knob magic-knob" id="chord-flux" min="0" max="100" onchange="updateChordParam('flux', this.value)"></div>
          </div>
        </div>

        <div class="config-grid" style="margin-bottom: 10px;">
          <div><label>PATTERN LIBRARY</label><select id="preset-select"></select></div>
        </div>

        <div id="grid-notes" class="step-container"></div>
        <div style="margin-top:15px; text-align:right;"><button onclick="clearCurrentPad()" class="btn-small" style="width:auto;">CLEAR PATTERN</button></div>
      </div>
    </div>
  </div>
</div>

<script type="module" src="interface.js"></script>

</body>
</html>
